{"cells":[{"cell_type":"code","execution_count":11,"metadata":{"id":"c-JdJwOaMWiS","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1698494902940,"user_tz":-480,"elapsed":6314,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"a528a0b4-9de4-46f4-93ed-9eee9a3351a5"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content\n","fatal: destination path 'PanoHead' already exists and is not an empty directory.\n","aria2 is already the newest version (1.36.0-1).\n","0 upgraded, 0 newly installed, 0 to remove and 19 not upgraded.\n","\n","Download Results:\n","gid   |stat|avg speed  |path/URI\n","======+====+===========+=======================================================\n","f40f6c|\u001b[1;32mOK\u001b[0m  |       0B/s|/content/PanoHead/models/ablation-trigridD-1-025000.pkl\n","\n","Status Legend:\n","(OK):download completed.\n","\n","Download Results:\n","gid   |stat|avg speed  |path/URI\n","======+====+===========+=======================================================\n","8998ec|\u001b[1;32mOK\u001b[0m  |       0B/s|/content/PanoHead/models/baseline-easy-khair-025000.pkl\n","\n","Status Legend:\n","(OK):download completed.\n","\n","Download Results:\n","gid   |stat|avg speed  |path/URI\n","======+====+===========+=======================================================\n","a7616b|\u001b[1;32mOK\u001b[0m  |       0B/s|/content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl\n","\n","Status Legend:\n","(OK):download completed.\n","Requirement already satisfied: imgui in /usr/local/lib/python3.10/dist-packages (2.0.0)\n","Requirement already satisfied: glfw in /usr/local/lib/python3.10/dist-packages (2.6.2)\n","Requirement already satisfied: pyspng in /usr/local/lib/python3.10/dist-packages (0.1.1)\n","Requirement already satisfied: mrcfile in /usr/local/lib/python3.10/dist-packages (1.4.3)\n","Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (1.11.1.1)\n","Requirement already satisfied: plyfile in /usr/local/lib/python3.10/dist-packages (1.0.1)\n","Requirement already satisfied: trimesh in /usr/local/lib/python3.10/dist-packages (4.0.1)\n","Requirement already satisfied: onnxruntime in /usr/local/lib/python3.10/dist-packages (1.16.1)\n","Requirement already satisfied: onnx in /usr/local/lib/python3.10/dist-packages (1.15.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from pyspng) (1.23.5)\n","Requirement already satisfied: coloredlogs in /usr/local/lib/python3.10/dist-packages (from onnxruntime) (15.0.1)\n","Requirement already satisfied: flatbuffers in /usr/local/lib/python3.10/dist-packages (from onnxruntime) (23.5.26)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from onnxruntime) (23.2)\n","Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from onnxruntime) (3.20.3)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from onnxruntime) (1.12)\n","Requirement already satisfied: humanfriendly>=9.1 in /usr/local/lib/python3.10/dist-packages (from coloredlogs->onnxruntime) (10.0)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->onnxruntime) (1.3.0)\n","\u001b[31mERROR: Operation cancelled by user\u001b[0m\u001b[31m\n","\u001b[0m/content\n","fatal: destination path '3DDFA_V2' already exists and is not an empty directory.\n","/content/3DDFA_V2\n","\n","Download Results:\n","gid   |stat|avg speed  |path/URI\n","======+====+===========+=======================================================\n","e7a6b7|\u001b[1;32mOK\u001b[0m  |       0B/s|/content/3DDFA_V2/shape_predictor_68_face_landmarks.dat\n","\n","Status Legend:\n","(OK):download completed.\n","mkdir: cannot create directory ‘/content/in’: File exists\n","mkdir: cannot create directory ‘/content/stage’: File exists\n","mkdir: cannot create directory ‘/content/output’: File exists\n"]}],"source":["%cd /content\n","!git clone -b dev1 https://github.com/camenduru/PanoHead\n","\n","!apt -y install -qq aria2\n","!aria2c --console-log-level=error -c -x 16 -s 16 -k 1M https://huggingface.co/camenduru/PanoHead/resolve/main/ablation-trigridD-1-025000.pkl -d /content/PanoHead/models -o ablation-trigridD-1-025000.pkl\n","!aria2c --console-log-level=error -c -x 16 -s 16 -k 1M https://huggingface.co/camenduru/PanoHead/resolve/main/baseline-easy-khair-025000.pkl -d /content/PanoHead/models -o baseline-easy-khair-025000.pkl\n","!aria2c --console-log-level=error -c -x 16 -s 16 -k 1M https://huggingface.co/camenduru/PanoHead/resolve/main/easy-khair-180-gpc0.8-trans10-025000.pkl -d /content/PanoHead/models -o easy-khair-180-gpc0.8-trans10-025000.pkl\n","\n","!pip install imgui glfw pyspng mrcfile ninja plyfile trimesh onnxruntime onnx\n","\n","%cd /content\n","!git clone -b dev https://github.com/camenduru/3DDFA_V2\n","%cd /content/3DDFA_V2\n","!sh ./build.sh\n","\n","!cp -rf /content/PanoHead/3DDFA_V2_cropping/test /content/3DDFA_V2\n","!cp /content/PanoHead/3DDFA_V2_cropping/dlib_kps.py /content/3DDFA_V2\n","!cp /content/PanoHead/3DDFA_V2_cropping/recrop_images.py /content/3DDFA_V2\n","\n","!aria2c --console-log-level=error -c -x 16 -s 16 -k 1M https://huggingface.co/camenduru/shape_predictor_68_face_landmarks/resolve/main/shape_predictor_68_face_landmarks.dat -d /content/3DDFA_V2 -o shape_predictor_68_face_landmarks.dat\n","\n","!mkdir /content/in /content/stage /content/output"]},{"cell_type":"code","source":[],"metadata":{"id":"5xUJxHTJWUjo"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":4,"metadata":{"id":"kCTVHf5sV9-x","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1698493595976,"user_tz":-480,"elapsed":7793,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"52f0b32e-57e3-4251-d86f-3bb315ed6133"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/3DDFA_V2\n","100% 1/1 [00:01<00:00,  1.45s/it]\n","results: 1\n"]}],"source":["# 运行这一步之前先放test.jpg到content下面的in目录\n","\n","%cd /content/3DDFA_V2\n","!rm -rf /content/stage/* /content/3DDFA_V2/crop_samples/img/* /content/3DDFA_V2/test/original/* /content/output/*\n","!cp /content/in/* /content/3DDFA_V2/test/original\n","\n","!python dlib_kps.py\n","!python recrop_images.py -i data.pkl -j dataset.json\n","\n","!cp -rf /content/3DDFA_V2/crop_samples/img/* /content/stage\n","\n","# %cd /content/PanoHead\n","# !./gen_pti_script.sh"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"fR4XzuBpV9-z","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1698493939373,"user_tz":-480,"elapsed":339848,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"8582b066-3f32-4ebc-e2c7-268c638165c7"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/PanoHead\n","Loading networks from \"/content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl\"...\n","projecting: [0] /content/stage/test.jpg\n","camera matrix: torch.Size([1, 25])\n","Computing W midpoint and stddev using 10000 samples...\n","Setting up PyTorch plugin \"bias_act_plugin\"... Done.\n","Downloading https://nvlabs-fi-cdn.nvidia.com/stylegan2-ada-pytorch/pretrained/metrics/vgg16.pt ... done\n","Setting up PyTorch plugin \"upfirdn2d_plugin\"... Done.\n","step:    1/300 mse: 0.36 perc: 0.56 w_norm: 0.00  noise: 0.00 \n","step:    2/300 mse: 0.47 perc: 0.54 w_norm: 0.00  noise: 0.00 \n","step:    3/300 mse: 0.46 perc: 0.53 w_norm: 0.00  noise: 0.00 \n","step:    4/300 mse: 0.40 perc: 0.58 w_norm: 0.00  noise: 0.00 \n","step:    5/300 mse: 0.21 perc: 0.54 w_norm: 0.00  noise: 0.00 \n","step:    6/300 mse: 0.26 perc: 0.48 w_norm: 0.00  noise: 0.00 \n","step:    7/300 mse: 0.09 perc: 0.44 w_norm: 0.00  noise: 0.00 \n","step:    8/300 mse: 0.09 perc: 0.47 w_norm: 0.01  noise: 0.00 \n","step:    9/300 mse: 0.08 perc: 0.44 w_norm: 0.01  noise: 0.00 \n","step:   10/300 mse: 0.11 perc: 0.46 w_norm: 0.01  noise: 0.00 \n","step:   11/300 mse: 0.11 perc: 0.44 w_norm: 0.02  noise: 0.00 \n","step:   12/300 mse: 0.11 perc: 0.45 w_norm: 0.02  noise: 0.00 \n","step:   13/300 mse: 0.10 perc: 0.45 w_norm: 0.03  noise: 0.00 \n","step:   14/300 mse: 0.12 perc: 0.44 w_norm: 0.03  noise: 0.00 \n","step:   15/300 mse: 0.10 perc: 0.45 w_norm: 0.04  noise: 0.00 \n","step:   16/300 mse: 0.09 perc: 0.41 w_norm: 0.05  noise: 0.00 \n","step:   17/300 mse: 0.13 perc: 0.41 w_norm: 0.05  noise: 0.00 \n","step:   18/300 mse: 0.10 perc: 0.39 w_norm: 0.06  noise: 0.00 \n","step:   19/300 mse: 0.07 perc: 0.39 w_norm: 0.06  noise: 0.00 \n","step:   20/300 mse: 0.08 perc: 0.39 w_norm: 0.07  noise: 0.00 \n","step:   21/300 mse: 0.08 perc: 0.38 w_norm: 0.07  noise: 0.00 \n","step:   22/300 mse: 0.07 perc: 0.39 w_norm: 0.08  noise: 0.00 \n","step:   23/300 mse: 0.07 perc: 0.37 w_norm: 0.08  noise: 0.00 \n","step:   24/300 mse: 0.06 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   25/300 mse: 0.06 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   26/300 mse: 0.06 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   27/300 mse: 0.08 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   28/300 mse: 0.05 perc: 0.37 w_norm: 0.09  noise: 0.00 \n","step:   29/300 mse: 0.06 perc: 0.37 w_norm: 0.09  noise: 0.00 \n","step:   30/300 mse: 0.06 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   31/300 mse: 0.06 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   32/300 mse: 0.05 perc: 0.34 w_norm: 0.08  noise: 0.00 \n","step:   33/300 mse: 0.07 perc: 0.34 w_norm: 0.08  noise: 0.00 \n","step:   34/300 mse: 0.05 perc: 0.33 w_norm: 0.08  noise: 0.00 \n","step:   35/300 mse: 0.05 perc: 0.36 w_norm: 0.08  noise: 0.00 \n","step:   36/300 mse: 0.05 perc: 0.35 w_norm: 0.08  noise: 0.00 \n","step:   37/300 mse: 0.06 perc: 0.35 w_norm: 0.08  noise: 0.00 \n","step:   38/300 mse: 0.06 perc: 0.34 w_norm: 0.07  noise: 0.00 \n","step:   39/300 mse: 0.05 perc: 0.31 w_norm: 0.07  noise: 0.00 \n","step:   40/300 mse: 0.07 perc: 0.33 w_norm: 0.07  noise: 0.00 \n","step:   41/300 mse: 0.06 perc: 0.33 w_norm: 0.07  noise: 0.00 \n","step:   42/300 mse: 0.06 perc: 0.33 w_norm: 0.07  noise: 0.00 \n","step:   43/300 mse: 0.05 perc: 0.32 w_norm: 0.07  noise: 0.00 \n","step:   44/300 mse: 0.05 perc: 0.32 w_norm: 0.07  noise: 0.00 \n","step:   45/300 mse: 0.05 perc: 0.33 w_norm: 0.07  noise: 0.00 \n","step:   46/300 mse: 0.05 perc: 0.32 w_norm: 0.07  noise: 0.00 \n","step:   47/300 mse: 0.06 perc: 0.31 w_norm: 0.07  noise: 0.00 \n","step:   48/300 mse: 0.05 perc: 0.31 w_norm: 0.07  noise: 0.00 \n","step:   49/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   50/300 mse: 0.05 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   51/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   52/300 mse: 0.05 perc: 0.31 w_norm: 0.06  noise: 0.00 \n","step:   53/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   54/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   55/300 mse: 0.06 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   56/300 mse: 0.05 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   57/300 mse: 0.04 perc: 0.28 w_norm: 0.06  noise: 0.00 \n","step:   58/300 mse: 0.04 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   59/300 mse: 0.04 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   60/300 mse: 0.04 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   61/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   62/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   63/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   64/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   65/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   66/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   67/300 mse: 0.05 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   68/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   69/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   70/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   71/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   72/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   73/300 mse: 0.05 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   74/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   75/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:   76/300 mse: 0.06 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   77/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:   78/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   79/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   80/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:   81/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   82/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   83/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   84/300 mse: 0.05 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   85/300 mse: 0.05 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:   86/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   87/300 mse: 0.04 perc: 0.29 w_norm: 0.05  noise: 0.00 \n","step:   88/300 mse: 0.04 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:   89/300 mse: 0.04 perc: 0.31 w_norm: 0.05  noise: 0.00 \n","step:   90/300 mse: 0.05 perc: 0.30 w_norm: 0.05  noise: 0.00 \n","step:   91/300 mse: 0.04 perc: 0.30 w_norm: 0.05  noise: 0.00 \n","step:   92/300 mse: 0.05 perc: 0.29 w_norm: 0.05  noise: 0.00 \n","step:   93/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   94/300 mse: 0.05 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   95/300 mse: 0.06 perc: 0.32 w_norm: 0.06  noise: 0.00 \n","step:   96/300 mse: 0.06 perc: 0.30 w_norm: 0.06  noise: 0.00 \n","step:   97/300 mse: 0.05 perc: 0.29 w_norm: 0.06  noise: 0.00 \n","step:   98/300 mse: 0.04 perc: 0.28 w_norm: 0.06  noise: 0.00 \n","step:   99/300 mse: 0.05 perc: 0.28 w_norm: 0.06  noise: 0.00 \n","step:  100/300 mse: 0.04 perc: 0.27 w_norm: 0.06  noise: 0.00 \n","step:  101/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  102/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  103/300 mse: 0.04 perc: 0.28 w_norm: 0.06  noise: 0.00 \n","step:  104/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  105/300 mse: 0.04 perc: 0.27 w_norm: 0.06  noise: 0.00 \n","step:  106/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  107/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  108/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  109/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  110/300 mse: 0.05 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  111/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  112/300 mse: 0.05 perc: 0.27 w_norm: 0.06  noise: 0.00 \n","step:  113/300 mse: 0.04 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  114/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  115/300 mse: 0.05 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  116/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  117/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  118/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  119/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  120/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  121/300 mse: 0.06 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:  122/300 mse: 0.06 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:  123/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  124/300 mse: 0.05 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  125/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  126/300 mse: 0.06 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  127/300 mse: 0.06 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  128/300 mse: 0.05 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  129/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  130/300 mse: 0.04 perc: 0.27 w_norm: 0.05  noise: 0.00 \n","step:  131/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  132/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  133/300 mse: 0.04 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  134/300 mse: 0.05 perc: 0.28 w_norm: 0.05  noise: 0.00 \n","step:  135/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  136/300 mse: 0.04 perc: 0.25 w_norm: 0.06  noise: 0.00 \n","step:  137/300 mse: 0.04 perc: 0.25 w_norm: 0.06  noise: 0.00 \n","step:  138/300 mse: 0.04 perc: 0.25 w_norm: 0.06  noise: 0.00 \n","step:  139/300 mse: 0.05 perc: 0.26 w_norm: 0.06  noise: 0.00 \n","step:  140/300 mse: 0.05 perc: 0.26 w_norm: 0.07  noise: 0.00 \n","step:  141/300 mse: 0.05 perc: 0.26 w_norm: 0.07  noise: 0.00 \n","step:  142/300 mse: 0.04 perc: 0.25 w_norm: 0.07  noise: 0.00 \n","step:  143/300 mse: 0.04 perc: 0.26 w_norm: 0.07  noise: 0.00 \n","step:  144/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  145/300 mse: 0.04 perc: 0.26 w_norm: 0.08  noise: 0.00 \n","step:  146/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  147/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  148/300 mse: 0.05 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  149/300 mse: 0.05 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  150/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  151/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  152/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  153/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  154/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  155/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  156/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  157/300 mse: 0.04 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  158/300 mse: 0.03 perc: 0.25 w_norm: 0.08  noise: 0.00 \n","step:  159/300 mse: 0.04 perc: 0.24 w_norm: 0.07  noise: 0.00 \n","step:  160/300 mse: 0.04 perc: 0.24 w_norm: 0.07  noise: 0.00 \n","step:  161/300 mse: 0.04 perc: 0.25 w_norm: 0.07  noise: 0.00 \n","step:  162/300 mse: 0.04 perc: 0.24 w_norm: 0.07  noise: 0.00 \n","step:  163/300 mse: 0.04 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  164/300 mse: 0.04 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  165/300 mse: 0.04 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  166/300 mse: 0.04 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  167/300 mse: 0.03 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  168/300 mse: 0.04 perc: 0.23 w_norm: 0.07  noise: 0.00 \n","step:  169/300 mse: 0.04 perc: 0.22 w_norm: 0.06  noise: 0.00 \n","step:  170/300 mse: 0.04 perc: 0.22 w_norm: 0.06  noise: 0.00 \n","step:  171/300 mse: 0.04 perc: 0.22 w_norm: 0.06  noise: 0.00 \n","step:  172/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  173/300 mse: 0.04 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  174/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  175/300 mse: 0.03 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  176/300 mse: 0.03 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  177/300 mse: 0.03 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  178/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  179/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  180/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  181/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  182/300 mse: 0.03 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  183/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  184/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  185/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  186/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  187/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  188/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  189/300 mse: 0.03 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  190/300 mse: 0.03 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  191/300 mse: 0.03 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  192/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  193/300 mse: 0.03 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  194/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  195/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  196/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  197/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  198/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  199/300 mse: 0.03 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  200/300 mse: 0.03 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  201/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  202/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  203/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  204/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  205/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  206/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  207/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  208/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  209/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  210/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  211/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  212/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  213/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  214/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  215/300 mse: 0.05 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  216/300 mse: 0.05 perc: 0.26 w_norm: 0.05  noise: 0.00 \n","step:  217/300 mse: 0.05 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  218/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  219/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  220/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  221/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  222/300 mse: 0.05 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  223/300 mse: 0.05 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  224/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  225/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  226/300 mse: 0.05 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  227/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  228/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  229/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  230/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  231/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  232/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  233/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  234/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  235/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  236/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  237/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  238/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  239/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  240/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  241/300 mse: 0.03 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  242/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  243/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  244/300 mse: 0.04 perc: 0.24 w_norm: 0.05  noise: 0.00 \n","step:  245/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  246/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  247/300 mse: 0.04 perc: 0.25 w_norm: 0.05  noise: 0.00 \n","step:  248/300 mse: 0.04 perc: 0.27 w_norm: 0.06  noise: 0.00 \n","step:  249/300 mse: 0.05 perc: 0.25 w_norm: 0.06  noise: 0.00 \n","step:  250/300 mse: 0.05 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  251/300 mse: 0.05 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  252/300 mse: 0.05 perc: 0.25 w_norm: 0.06  noise: 0.00 \n","step:  253/300 mse: 0.05 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  254/300 mse: 0.04 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  255/300 mse: 0.04 perc: 0.24 w_norm: 0.06  noise: 0.00 \n","step:  256/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  257/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  258/300 mse: 0.04 perc: 0.22 w_norm: 0.06  noise: 0.00 \n","step:  259/300 mse: 0.04 perc: 0.22 w_norm: 0.06  noise: 0.00 \n","step:  260/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  261/300 mse: 0.05 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  262/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  263/300 mse: 0.04 perc: 0.23 w_norm: 0.06  noise: 0.00 \n","step:  264/300 mse: 0.04 perc: 0.23 w_norm: 0.05  noise: 0.00 \n","step:  265/300 mse: 0.04 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  266/300 mse: 0.03 perc: 0.22 w_norm: 0.05  noise: 0.00 \n","step:  267/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  268/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  269/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  270/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  271/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  272/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  273/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  274/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  275/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  276/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  277/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  278/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  279/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  280/300 mse: 0.03 perc: 0.21 w_norm: 0.05  noise: 0.00 \n","step:  281/300 mse: 0.03 perc: 0.21 w_norm: 0.04  noise: 0.00 \n","step:  282/300 mse: 0.03 perc: 0.21 w_norm: 0.04  noise: 0.00 \n","step:  283/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  284/300 mse: 0.03 perc: 0.21 w_norm: 0.04  noise: 0.00 \n","step:  285/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  286/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  287/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  288/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  289/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  290/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  291/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  292/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  293/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  294/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  295/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  296/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  297/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  298/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  299/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","step:  300/300 mse: 0.03 perc: 0.20 w_norm: 0.04  noise: 0.00 \n","Elapsed: 188.2 s\n","step:    1/300 mse: 0.03 perc: 0.20\n","step:    2/300 mse: 0.03 perc: 0.20\n","step:    3/300 mse: 0.03 perc: 0.19\n","step:    4/300 mse: 0.03 perc: 0.19\n","step:    5/300 mse: 0.03 perc: 0.19\n","step:    6/300 mse: 0.03 perc: 0.19\n","step:    7/300 mse: 0.03 perc: 0.18\n","step:    8/300 mse: 0.03 perc: 0.18\n","step:    9/300 mse: 0.03 perc: 0.18\n","step:   10/300 mse: 0.03 perc: 0.18\n","step:   11/300 mse: 0.03 perc: 0.18\n","step:   12/300 mse: 0.03 perc: 0.18\n","step:   13/300 mse: 0.03 perc: 0.17\n","step:   14/300 mse: 0.03 perc: 0.17\n","step:   15/300 mse: 0.03 perc: 0.17\n","step:   16/300 mse: 0.03 perc: 0.17\n","step:   17/300 mse: 0.03 perc: 0.17\n","step:   18/300 mse: 0.03 perc: 0.17\n","step:   19/300 mse: 0.03 perc: 0.17\n","step:   20/300 mse: 0.03 perc: 0.16\n","step:   21/300 mse: 0.03 perc: 0.16\n","step:   22/300 mse: 0.03 perc: 0.16\n","step:   23/300 mse: 0.03 perc: 0.16\n","step:   24/300 mse: 0.03 perc: 0.16\n","step:   25/300 mse: 0.03 perc: 0.16\n","step:   26/300 mse: 0.03 perc: 0.16\n","step:   27/300 mse: 0.03 perc: 0.16\n","step:   28/300 mse: 0.03 perc: 0.16\n","step:   29/300 mse: 0.03 perc: 0.16\n","step:   30/300 mse: 0.03 perc: 0.15\n","step:   31/300 mse: 0.03 perc: 0.15\n","step:   32/300 mse: 0.03 perc: 0.15\n","step:   33/300 mse: 0.03 perc: 0.15\n","step:   34/300 mse: 0.03 perc: 0.15\n","step:   35/300 mse: 0.03 perc: 0.15\n","step:   36/300 mse: 0.03 perc: 0.15\n","step:   37/300 mse: 0.03 perc: 0.15\n","step:   38/300 mse: 0.03 perc: 0.15\n","step:   39/300 mse: 0.03 perc: 0.15\n","step:   40/300 mse: 0.03 perc: 0.15\n","step:   41/300 mse: 0.03 perc: 0.15\n","step:   42/300 mse: 0.02 perc: 0.14\n","step:   43/300 mse: 0.02 perc: 0.15\n","step:   44/300 mse: 0.02 perc: 0.14\n","step:   45/300 mse: 0.02 perc: 0.14\n","step:   46/300 mse: 0.02 perc: 0.14\n","step:   47/300 mse: 0.02 perc: 0.14\n","step:   48/300 mse: 0.02 perc: 0.14\n","step:   49/300 mse: 0.02 perc: 0.14\n","step:   50/300 mse: 0.02 perc: 0.14\n","step:   51/300 mse: 0.02 perc: 0.14\n","step:   52/300 mse: 0.02 perc: 0.14\n","step:   53/300 mse: 0.02 perc: 0.14\n","step:   54/300 mse: 0.02 perc: 0.14\n","step:   55/300 mse: 0.02 perc: 0.14\n","step:   56/300 mse: 0.02 perc: 0.14\n","step:   57/300 mse: 0.02 perc: 0.14\n","step:   58/300 mse: 0.02 perc: 0.14\n","step:   59/300 mse: 0.02 perc: 0.13\n","step:   60/300 mse: 0.02 perc: 0.13\n","step:   61/300 mse: 0.02 perc: 0.13\n","step:   62/300 mse: 0.02 perc: 0.13\n","step:   63/300 mse: 0.02 perc: 0.13\n","step:   64/300 mse: 0.02 perc: 0.13\n","step:   65/300 mse: 0.02 perc: 0.13\n","step:   66/300 mse: 0.02 perc: 0.13\n","step:   67/300 mse: 0.02 perc: 0.13\n","step:   68/300 mse: 0.02 perc: 0.13\n","step:   69/300 mse: 0.02 perc: 0.13\n","step:   70/300 mse: 0.02 perc: 0.13\n","step:   71/300 mse: 0.02 perc: 0.13\n","step:   72/300 mse: 0.02 perc: 0.13\n","step:   73/300 mse: 0.02 perc: 0.13\n","step:   74/300 mse: 0.02 perc: 0.13\n","step:   75/300 mse: 0.02 perc: 0.13\n","step:   76/300 mse: 0.02 perc: 0.13\n","step:   77/300 mse: 0.02 perc: 0.13\n","step:   78/300 mse: 0.02 perc: 0.13\n","step:   79/300 mse: 0.02 perc: 0.13\n","step:   80/300 mse: 0.02 perc: 0.13\n","step:   81/300 mse: 0.02 perc: 0.12\n","step:   82/300 mse: 0.02 perc: 0.12\n","step:   83/300 mse: 0.02 perc: 0.12\n","step:   84/300 mse: 0.02 perc: 0.12\n","step:   85/300 mse: 0.02 perc: 0.12\n","step:   86/300 mse: 0.02 perc: 0.12\n","step:   87/300 mse: 0.02 perc: 0.12\n","step:   88/300 mse: 0.02 perc: 0.12\n","step:   89/300 mse: 0.02 perc: 0.12\n","step:   90/300 mse: 0.02 perc: 0.12\n","step:   91/300 mse: 0.02 perc: 0.12\n","step:   92/300 mse: 0.02 perc: 0.12\n","step:   93/300 mse: 0.02 perc: 0.12\n","step:   94/300 mse: 0.02 perc: 0.12\n","step:   95/300 mse: 0.02 perc: 0.12\n","step:   96/300 mse: 0.02 perc: 0.12\n","step:   97/300 mse: 0.02 perc: 0.12\n","step:   98/300 mse: 0.02 perc: 0.12\n","step:   99/300 mse: 0.02 perc: 0.12\n","step:  100/300 mse: 0.02 perc: 0.12\n","step:  101/300 mse: 0.02 perc: 0.12\n","step:  102/300 mse: 0.02 perc: 0.12\n","step:  103/300 mse: 0.02 perc: 0.12\n","step:  104/300 mse: 0.02 perc: 0.12\n","step:  105/300 mse: 0.02 perc: 0.12\n","step:  106/300 mse: 0.02 perc: 0.12\n","step:  107/300 mse: 0.02 perc: 0.12\n","step:  108/300 mse: 0.02 perc: 0.12\n","step:  109/300 mse: 0.02 perc: 0.12\n","step:  110/300 mse: 0.02 perc: 0.12\n","step:  111/300 mse: 0.02 perc: 0.11\n","step:  112/300 mse: 0.02 perc: 0.11\n","step:  113/300 mse: 0.02 perc: 0.11\n","step:  114/300 mse: 0.02 perc: 0.11\n","step:  115/300 mse: 0.02 perc: 0.11\n","step:  116/300 mse: 0.02 perc: 0.11\n","step:  117/300 mse: 0.02 perc: 0.11\n","step:  118/300 mse: 0.02 perc: 0.11\n","step:  119/300 mse: 0.02 perc: 0.11\n","step:  120/300 mse: 0.02 perc: 0.11\n","step:  121/300 mse: 0.02 perc: 0.11\n","step:  122/300 mse: 0.02 perc: 0.11\n","step:  123/300 mse: 0.02 perc: 0.11\n","step:  124/300 mse: 0.02 perc: 0.11\n","step:  125/300 mse: 0.02 perc: 0.11\n","step:  126/300 mse: 0.02 perc: 0.11\n","step:  127/300 mse: 0.02 perc: 0.11\n","step:  128/300 mse: 0.02 perc: 0.11\n","step:  129/300 mse: 0.02 perc: 0.11\n","step:  130/300 mse: 0.02 perc: 0.11\n","step:  131/300 mse: 0.02 perc: 0.11\n","step:  132/300 mse: 0.02 perc: 0.11\n","step:  133/300 mse: 0.02 perc: 0.11\n","step:  134/300 mse: 0.02 perc: 0.11\n","step:  135/300 mse: 0.02 perc: 0.11\n","step:  136/300 mse: 0.02 perc: 0.11\n","step:  137/300 mse: 0.02 perc: 0.11\n","step:  138/300 mse: 0.02 perc: 0.11\n","step:  139/300 mse: 0.01 perc: 0.11\n","step:  140/300 mse: 0.01 perc: 0.11\n","step:  141/300 mse: 0.01 perc: 0.11\n","step:  142/300 mse: 0.01 perc: 0.11\n","step:  143/300 mse: 0.01 perc: 0.11\n","step:  144/300 mse: 0.01 perc: 0.11\n","step:  145/300 mse: 0.01 perc: 0.11\n","step:  146/300 mse: 0.01 perc: 0.11\n","step:  147/300 mse: 0.01 perc: 0.11\n","step:  148/300 mse: 0.01 perc: 0.11\n","step:  149/300 mse: 0.01 perc: 0.11\n","step:  150/300 mse: 0.01 perc: 0.10\n","step:  151/300 mse: 0.01 perc: 0.10\n","step:  152/300 mse: 0.01 perc: 0.10\n","step:  153/300 mse: 0.01 perc: 0.10\n","step:  154/300 mse: 0.01 perc: 0.10\n","step:  155/300 mse: 0.01 perc: 0.10\n","step:  156/300 mse: 0.01 perc: 0.10\n","step:  157/300 mse: 0.01 perc: 0.10\n","step:  158/300 mse: 0.01 perc: 0.10\n","step:  159/300 mse: 0.01 perc: 0.10\n","step:  160/300 mse: 0.01 perc: 0.10\n","step:  161/300 mse: 0.01 perc: 0.10\n","step:  162/300 mse: 0.01 perc: 0.10\n","step:  163/300 mse: 0.01 perc: 0.10\n","step:  164/300 mse: 0.01 perc: 0.10\n","step:  165/300 mse: 0.01 perc: 0.10\n","step:  166/300 mse: 0.01 perc: 0.10\n","step:  167/300 mse: 0.01 perc: 0.10\n","step:  168/300 mse: 0.01 perc: 0.10\n","step:  169/300 mse: 0.01 perc: 0.10\n","step:  170/300 mse: 0.01 perc: 0.10\n","step:  171/300 mse: 0.01 perc: 0.10\n","step:  172/300 mse: 0.01 perc: 0.10\n","step:  173/300 mse: 0.01 perc: 0.10\n","step:  174/300 mse: 0.01 perc: 0.10\n","step:  175/300 mse: 0.01 perc: 0.10\n","step:  176/300 mse: 0.01 perc: 0.10\n","step:  177/300 mse: 0.01 perc: 0.10\n","step:  178/300 mse: 0.01 perc: 0.10\n","step:  179/300 mse: 0.01 perc: 0.10\n","step:  180/300 mse: 0.01 perc: 0.10\n","step:  181/300 mse: 0.01 perc: 0.10\n","step:  182/300 mse: 0.01 perc: 0.10\n","step:  183/300 mse: 0.01 perc: 0.10\n","step:  184/300 mse: 0.01 perc: 0.10\n","step:  185/300 mse: 0.01 perc: 0.10\n","step:  186/300 mse: 0.01 perc: 0.10\n","step:  187/300 mse: 0.01 perc: 0.10\n","step:  188/300 mse: 0.01 perc: 0.10\n","step:  189/300 mse: 0.01 perc: 0.10\n","step:  190/300 mse: 0.01 perc: 0.09\n","step:  191/300 mse: 0.01 perc: 0.10\n","step:  192/300 mse: 0.01 perc: 0.10\n","step:  193/300 mse: 0.01 perc: 0.09\n","step:  194/300 mse: 0.01 perc: 0.09\n","step:  195/300 mse: 0.01 perc: 0.10\n","step:  196/300 mse: 0.01 perc: 0.09\n","step:  197/300 mse: 0.01 perc: 0.09\n","step:  198/300 mse: 0.01 perc: 0.09\n","step:  199/300 mse: 0.01 perc: 0.09\n","step:  200/300 mse: 0.01 perc: 0.09\n","step:  201/300 mse: 0.01 perc: 0.09\n","step:  202/300 mse: 0.01 perc: 0.09\n","step:  203/300 mse: 0.01 perc: 0.09\n","step:  204/300 mse: 0.01 perc: 0.09\n","step:  205/300 mse: 0.01 perc: 0.09\n","step:  206/300 mse: 0.01 perc: 0.09\n","step:  207/300 mse: 0.01 perc: 0.09\n","step:  208/300 mse: 0.01 perc: 0.09\n","step:  209/300 mse: 0.01 perc: 0.09\n","step:  210/300 mse: 0.01 perc: 0.09\n","step:  211/300 mse: 0.01 perc: 0.09\n","step:  212/300 mse: 0.01 perc: 0.09\n","step:  213/300 mse: 0.01 perc: 0.09\n","step:  214/300 mse: 0.01 perc: 0.09\n","step:  215/300 mse: 0.01 perc: 0.09\n","step:  216/300 mse: 0.01 perc: 0.09\n","step:  217/300 mse: 0.01 perc: 0.09\n","step:  218/300 mse: 0.01 perc: 0.09\n","step:  219/300 mse: 0.01 perc: 0.09\n","step:  220/300 mse: 0.01 perc: 0.09\n","step:  221/300 mse: 0.01 perc: 0.09\n","step:  222/300 mse: 0.01 perc: 0.09\n","step:  223/300 mse: 0.01 perc: 0.09\n","step:  224/300 mse: 0.01 perc: 0.09\n","step:  225/300 mse: 0.01 perc: 0.09\n","step:  226/300 mse: 0.01 perc: 0.09\n","step:  227/300 mse: 0.01 perc: 0.09\n","step:  228/300 mse: 0.01 perc: 0.09\n","step:  229/300 mse: 0.01 perc: 0.09\n","step:  230/300 mse: 0.01 perc: 0.09\n","step:  231/300 mse: 0.01 perc: 0.09\n","step:  232/300 mse: 0.01 perc: 0.09\n","step:  233/300 mse: 0.01 perc: 0.09\n","step:  234/300 mse: 0.01 perc: 0.09\n","step:  235/300 mse: 0.01 perc: 0.09\n","step:  236/300 mse: 0.01 perc: 0.09\n","step:  237/300 mse: 0.01 perc: 0.09\n","step:  238/300 mse: 0.01 perc: 0.09\n","step:  239/300 mse: 0.01 perc: 0.09\n","step:  240/300 mse: 0.01 perc: 0.09\n","step:  241/300 mse: 0.01 perc: 0.09\n","step:  242/300 mse: 0.01 perc: 0.09\n","step:  243/300 mse: 0.01 perc: 0.09\n","step:  244/300 mse: 0.01 perc: 0.09\n","step:  245/300 mse: 0.01 perc: 0.09\n","step:  246/300 mse: 0.01 perc: 0.09\n","step:  247/300 mse: 0.01 perc: 0.09\n","step:  248/300 mse: 0.01 perc: 0.09\n","step:  249/300 mse: 0.01 perc: 0.09\n","step:  250/300 mse: 0.01 perc: 0.09\n","step:  251/300 mse: 0.01 perc: 0.09\n","step:  252/300 mse: 0.01 perc: 0.09\n","step:  253/300 mse: 0.01 perc: 0.09\n","step:  254/300 mse: 0.01 perc: 0.08\n","step:  255/300 mse: 0.01 perc: 0.08\n","step:  256/300 mse: 0.01 perc: 0.09\n","step:  257/300 mse: 0.01 perc: 0.08\n","step:  258/300 mse: 0.01 perc: 0.08\n","step:  259/300 mse: 0.01 perc: 0.08\n","step:  260/300 mse: 0.01 perc: 0.08\n","step:  261/300 mse: 0.01 perc: 0.08\n","step:  262/300 mse: 0.01 perc: 0.08\n","step:  263/300 mse: 0.01 perc: 0.08\n","step:  264/300 mse: 0.01 perc: 0.08\n","step:  265/300 mse: 0.01 perc: 0.08\n","step:  266/300 mse: 0.01 perc: 0.08\n","step:  267/300 mse: 0.01 perc: 0.08\n","step:  268/300 mse: 0.01 perc: 0.08\n","step:  269/300 mse: 0.01 perc: 0.08\n","step:  270/300 mse: 0.01 perc: 0.08\n","step:  271/300 mse: 0.01 perc: 0.08\n","step:  272/300 mse: 0.01 perc: 0.08\n","step:  273/300 mse: 0.01 perc: 0.08\n","step:  274/300 mse: 0.01 perc: 0.08\n","step:  275/300 mse: 0.01 perc: 0.08\n","step:  276/300 mse: 0.01 perc: 0.08\n","step:  277/300 mse: 0.01 perc: 0.08\n","step:  278/300 mse: 0.01 perc: 0.08\n","step:  279/300 mse: 0.01 perc: 0.08\n","step:  280/300 mse: 0.01 perc: 0.08\n","step:  281/300 mse: 0.01 perc: 0.08\n","step:  282/300 mse: 0.01 perc: 0.08\n","step:  283/300 mse: 0.01 perc: 0.08\n","step:  284/300 mse: 0.01 perc: 0.08\n","step:  285/300 mse: 0.01 perc: 0.08\n","step:  286/300 mse: 0.01 perc: 0.08\n","step:  287/300 mse: 0.01 perc: 0.08\n","step:  288/300 mse: 0.01 perc: 0.08\n","step:  289/300 mse: 0.01 perc: 0.08\n","step:  290/300 mse: 0.01 perc: 0.08\n","step:  291/300 mse: 0.01 perc: 0.08\n","step:  292/300 mse: 0.01 perc: 0.08\n","step:  293/300 mse: 0.01 perc: 0.08\n","step:  294/300 mse: 0.01 perc: 0.08\n","step:  295/300 mse: 0.01 perc: 0.08\n","step:  296/300 mse: 0.01 perc: 0.08\n","step:  297/300 mse: 0.01 perc: 0.08\n","step:  298/300 mse: 0.01 perc: 0.08\n","step:  299/300 mse: 0.01 perc: 0.08\n","step:  300/300 mse: 0.01 perc: 0.08\n","Elapsed: 306.9 s\n","Saving optimization progress video \"/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/proj.mp4\"\n"]}],"source":["%cd /content/PanoHead\n","!python projector_withseg.py --num-steps=300 --num-steps-pti=300 --outdir=/content/output --target_img=/content/stage --network=/content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl --idx 0"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"AADsw5P3V9-0","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1698494157025,"user_tz":-480,"elapsed":47212,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"4643a165-9207-49b9-8954-1a053a686aeb"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/PanoHead\n","Loading networks from \"/content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl\"...\n","Setting up PyTorch plugin \"bias_act_plugin\"... Done.\n","Setting up PyTorch plugin \"upfirdn2d_plugin\"... Done.\n","100% 240/240 [00:25<00:00,  9.31it/s]\n"]}],"source":["%cd /content/PanoHead\n","!python gen_videos_proj_withseg.py --output=/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/PTI_render/pre.mp4 --latent=/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/projected_w.npz --trunc 0.7 --network /content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl --cfg Head"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"HEslOdQzV9-1","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1698494223358,"user_tz":-480,"elapsed":38796,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"91276a14-23fc-4c2b-921a-cecae9343e34"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/PanoHead\n","Loading networks from \"/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/fintuned_generator.pkl\"...\n","Setting up PyTorch plugin \"bias_act_plugin\"... Done.\n","Setting up PyTorch plugin \"upfirdn2d_plugin\"... Done.\n","100% 240/240 [00:26<00:00,  9.05it/s]\n"]}],"source":["%cd /content/PanoHead\n","!python gen_videos_proj_withseg.py --output=/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/PTI_render/post.mp4 --latent=/content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/projected_w.npz --trunc 0.7 --network /content/output/easy-khair-180-gpc0.8-trans10-025000.pkl/0/fintuned_generator.pkl --cfg Head"]},{"cell_type":"code","source":["%cd /content/PanoHead\n","!python gen_samples.py --outdir=out --shape-format=.ply --trunc=0.7 --shapes=true --seeds=0 --network /content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nZeD1urkWVli","executionInfo":{"status":"ok","timestamp":1698494283188,"user_tz":-480,"elapsed":40128,"user":{"displayName":"Irina Slunaker","userId":"10151423050085260997"}},"outputId":"01d70259-e94e-45f7-c7c0-3d80cf03e305"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/PanoHead\n","Loading networks from \"/content/PanoHead/models/easy-khair-180-gpc0.8-trans10-025000.pkl\"...\n","Generating image for seed 0 (0/1) ...\n","Setting up PyTorch plugin \"bias_act_plugin\"... Done.\n","Setting up PyTorch plugin \"upfirdn2d_plugin\"... Done.\n","135000000it [00:08, 16800988.78it/s]                   \n","wrote to out/easy-khair-180-gpc0.8-trans10-025000_90/seed0000.ply\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[{"file_id":"https://github.com/camenduru/PanoHead-colab/blob/main/PanoHead_custom_colab.ipynb","timestamp":1690981367468}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}